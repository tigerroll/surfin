surfin:
  adapter:
    database:
      # Framework metadata database (Postgres)
      metadata:
        type: "postgres"
        host: "postgres"
        port: 5432
        database: "main"
        user: "weather"
        password: "weather"
        schema: "public"
        sslmode: "disable"
        # Connection pool settings
        pool:
          max_open_conns: 10
          max_idle_conns: 5
          conn_max_lifetime_minutes: 5

      # Application workload database (Postgres)
      workload:
        type: "postgres"
        host: "postgres"
        port: 5432
        database: "main"
        user: "weather"
        password: "weather"
        schema: "public"
        sslmode: "disable"
        # Connection pool settings
        pool:
          max_open_conns: 10
          max_idle_conns: 5
          conn_max_lifetime_minutes: 5

      # Application workload database (MySQL)
      mysql:
        type: "mysql"
        host: "mysql"
        port: 3306
        database: "main"
        user: "weather"
        password: "weather"
        schema: "main"
        sslmode: "disable"
        # Connection pool settings
        pool:
          max_open_conns: 10
          max_idle_conns: 5
          conn_max_lifetime_minutes: 5

      # SQLite database for local development/testing
      sqlite:
        type: "sqlite"
        database: "surfin.db" # File path
        pool:
          max_open_conns: 1
          max_idle_conns: 1
          conn_max_lifetime_minutes: 0

  # Batch framework settings
  batch:
    polling_interval_seconds: 3600 # Polling interval (seconds)
    api_endpoint: "https://api.open-meteo.com/v1" # Open-Meteo API base URL
    api_key: ""
    job_name: "weatherJob"
    # Step-level retry settings (for the entire chunk process)
    retry:
      max_attempts: 3
      initial_interval: 1
      max_interval: 10
      factor: 2
      circuit_breaker_threshold: 3
      circuit_breaker_reset_interval: 60
    # Item-level retry settings
    item_retry:
      max_attempts: 3
      retryable_exceptions: ["io.EOF", "net.OpError"]
    # Item-level skip settings
    item_skip:
      skip_limit: 5
      skippable_exceptions: ["json.UnmarshalTypeError"]
    chunk_size: 50 # Default chunk size.

  # System-wide settings
  system:
    timezone: "Asia/Tokyo"
    logging:
      level: "DEBUG"
      format: "json" # Default log format is JSON.
      
  # Infrastructure settings
  infrastructure:
    job_repository_db_ref: "metadata" # DB connection name used by JobRepository
